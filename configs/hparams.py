## The cuurent hyper-parameters values are not necessarily the best ones for a specific risk.
def get_hparams_class(dataset_name, backbone_name):
    """Return the algorithm class with the given name."""
    if f"{dataset_name}_{backbone_name}" not in globals():
        raise NotImplementedError(f"Dataset not found: {dataset_name}_{backbone_name}")
    return globals()[dataset_name]

#TODO : merge all hparams
class EEG_CNN():
    def __init__(self):
        super(EEG_CNN, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 20, #4,
            'num_epochs_pr': 20,  # 20,
            'weight_decay': 1e-4,

        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 0.05,
           'learning_rate': 0.0001,
           'margin': 0.55,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.0005,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.01,
          'batch_size': 32,
          'beta': 0.001,
          'learning_rate': 0.01,
          'n_entropy': 0.1,
          'neg': 0.4,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.4,
          'p_entropy': 0.6000000000000001,
          'reg': 0.1,
          'tau': 0.35000000000000003,
          'tau1': 0.6000000000000001,
          'tau2': 1.6,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 64,
         'domain_loss_wt': 1,
         'learning_rate': 0.0001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 3.95,
         'w0': 0.95,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 5,
             'alpha': 4.05,
             'batch_size': 64,
             'joint_decision': True,
             'lamb': 1.65,
             'learning_rate': 0.0005,
             'n_batch': 10,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 3.8,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 32,
             'weight_decay': 0.0001},
 'UniOT': {'K': 15,
           'MQ_size': 1000,
           'batch_size': 32,
           'gamma': 0.9000000000000001,
           'lam': 1.6,
           'learning_rate': 0.0001,
           'mu': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HHAR_CNN():
    def __init__(self):
        super(HHAR_CNN).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 1.3,
           'learning_rate': 0.0001,
           'margin': 0.7000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.5,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.001,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.1,
          'n_entropy': 1.2000000000000002,
          'neg': 0.5,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 2.8,
          'p_entropy': 0.15000000000000002,
          'reg': 0.1,
          'tau': 0.7000000000000001,
          'tau1': 0.4,
          'tau2': 1.55,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 3.25,
         'learning_rate': 0.0001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.75,
         'w0': 0.95,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 10,
             'alpha': 2.95,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 4.6,
             'learning_rate': 0.0001,
             'n_batch': 10,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 0.1,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 32,
             'weight_decay': 0.0001},
 'UniOT': {'K': 5,
           'MQ_size': 2000,
           'batch_size': 32,
           'gamma': 0.5,
           'lam': 0.2,
           'learning_rate': 0.0001,
           'mu': 0.6000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.1,
           'weight_decay': 0.0001}}


class HAR_CNN():
    def __init__(self):
        super(HAR_CNN, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            # 64*2*2,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {
    'DANCE': {'batch_size': 64,
           'eta': 4.5,
           'learning_rate': 0.0005,
           'margin': 0.1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.1,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT_save': {'alpha': 0.001,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.01,
          'n_entropy': 1.05,
          'neg': 0.3,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 4.2,
          'p_entropy': 0.1,
          'reg': 0.1,
          'tau': 0.9000000000000001,
          'tau1': 0.8500000000000001,
          'tau2': 0.95,
          'thresh': 0.95,
          'weight_decay': 0.0001},
'PPOT': {'alpha': 0.001,
         'batch_size': 32,
         'beta': 0.01,
         'learning_rate': 0.1,
         'n_entropy': 0.05,
         'neg': 0.2,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'ot': 3.95,
         'p_entropy': 0.15000000000000002,
         'reg': 0.1,
         'tau': 0.8,
         'tau1': 0.8500000000000001,
         'tau2': 1.05,
         'thresh': 1,
         'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 3.9,
         'learning_rate': 0.0001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.05,
         'w0': 0.8,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 15,
             'alpha': 2.8,
             'batch_size': 64,
             'joint_decision': True,
             'lamb': 1.35,
             'learning_rate': 0.0005,
             'n_batch': 10,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 0.1,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 32,
             'weight_decay': 0.0001},
 'UniOT': {'K': 15,
           'MQ_size': 2000,
           'batch_size': 32,
           'gamma': 0.6500000000000001,
           'lam': 0.25,
           'learning_rate': 0.0001,
           'mu': 0.5,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.1,
           'weight_decay': 0.0001}}


class EEG_FNO():
    def __init__(self):
        super(EEG_FNO, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 20, #4,
            'num_epochs_pr': 20,  # 20,
            'weight_decay': 1e-4,

        }
        self.alg_hparams = {'DANCE': {'batch_size': 32,
           'eta': 0.8,
           'learning_rate': 0.01,
           'margin': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 32,
            'learning_rate': 0.01,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.001,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.0001,
          'n_entropy': 1.2500000000000002,
          'neg': 0.4,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.95,
          'p_entropy': 2,
          'reg': 0.1,
          'tau': 0.8500000000000001,
          'tau1': 0.2,
          'tau2': 1.95,
          'thresh': 0.95,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 64,
         'domain_loss_wt': 1.7000000000000002,
         'learning_rate': 0.0001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.75,
         'w0': 0.95,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 10,
             'alpha': 1.2500000000000002,
             'batch_size': 64,
             'joint_decision': True,
             'lamb': 1.7000000000000002,
             'learning_rate': 0.001,
             'n_batch': 15,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 0.7000000000000001,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 32,
             'weight_decay': 0.0001},
 'UniOT': {'K': 10,
           'MQ_size': 128,
           'batch_size': 64,
           'gamma': 0.7500000000000001,
           'lam': 3.35,
           'learning_rate': 0.0001,
           'mu': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HHAR_FNO():
    def __init__(self):
        super().__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 0.5,
           'learning_rate': 0.01,
           'margin': 0.9000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 32,
            'learning_rate': 0.0005,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.001,
          'batch_size': 32,
          'beta': 0.001,
          'learning_rate': 0.0001,
          'n_entropy': 0.25,
          'neg': 0.25,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 4.75,
          'p_entropy': 0.1,
          'reg': 0.01,
          'tau': 0.7000000000000001,
          'tau1': 0.6500000000000001,
          'tau2': 1.05,
          'thresh': 0.8,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 4.25,
         'learning_rate': 0.0005,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 0.95,
         'w0': 0.9000000000000001,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 5,
             'alpha': 4.8500000000000005,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 2.55,
             'learning_rate': 0.0001,
             'n_batch': 10,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 0.8,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 128,
             'weight_decay': 0.0001},
 'UniOT': {'K': 15,
           'MQ_size': 1000,
           'batch_size': 64,
           'gamma': 0.3,
           'lam': 2.1999999999999997,
           'learning_rate': 0.0001,
           'mu': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.1,
           'weight_decay': 0.0001}}


class HAR_FNO():
    def __init__(self):
        super(HAR_FNO, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            # 64*2*2,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 0.1,
           'learning_rate': 0.01,
           'margin': 0.7000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.5,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.01,
          'batch_size': 64,
          'beta': 0.01,
          'learning_rate': 0.0001,
          'n_entropy': 0.3,
          'neg': 0.25,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.8500000000000001,
          'p_entropy': 0.4,
          'reg': 0.1,
          'tau': 0.05,
          'tau1': 0.9000000000000001,
          'tau2': 1.9,
          'thresh': 0.7500000000000001,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 0.55,
         'learning_rate': 0.0005,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.95,
         'w0': 0.95,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 20,
             'alpha': 5,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 5,
             'learning_rate': 0.001,
             'n_batch': 5,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 0.45,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 64,
             'weight_decay': 0.0001},
 'UniOT': {'K': 5,
           'MQ_size': 2000,
           'batch_size': 32,
           'gamma': 0.8500000000000001,
           'lam': 3.4,
           'learning_rate': 0.001,
           'mu': 0.25,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class EEG_S3Layer():
    def __init__(self):
        super(EEG_S3Layer, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 20, #4,
            'num_epochs_pr': 20,  # 20,
            'weight_decay': 1e-4,

        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 0.15000000000000002,
           'learning_rate': 0.0001,
           'margin': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.001,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.001,
          'batch_size': 64,
          'beta': 0.01,
          'learning_rate': 0.01,
          'n_entropy': 0.9000000000000001,
          'neg': 0.4,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.4,
          'p_entropy': 0.9000000000000001,
          'reg': 0.1,
          'tau': 0.8500000000000001,
          'tau1': 0.8,
          'tau2': 0.15000000000000002,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 64,
         'domain_loss_wt': 2.25,
         'learning_rate': 0.0001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 3.75,
         'w0': 0.95,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 15,
             'alpha': 0.2,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 0.35000000000000003,
             'learning_rate': 0.0005,
             'n_batch': 10,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 1,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 64,
             'weight_decay': 0.0001},
 'UniOT': {'K': 5,
           'MQ_size': 2000,
           'batch_size': 64,
           'gamma': 1,
           'lam': 2.7,
           'learning_rate': 0.001,
           'mu': 0.8,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HHAR_S3Layer():
    def __init__(self):
        super().__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 1.4,
           'learning_rate': 0.0001,
           'margin': 0.7000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.005,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.01,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.01,
          'n_entropy': 1.6,
          'neg': 0.4,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 2.3,
          'p_entropy': 0.8500000000000001,
          'reg': 0.1,
          'tau': 0.8,
          'tau1': 0.7000000000000001,
          'tau2': 1.15,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 4.75,
         'learning_rate': 0.0005,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 1.95,
         'w0': 0.8500000000000001,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 5,
             'alpha': 2.85,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 3.95,
             'learning_rate': 0.0001,
             'n_batch': 20,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 1.7500000000000002,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 128,
             'weight_decay': 0.0001},
 'UniOT': {'K': 5,
           'MQ_size': 1000,
           'batch_size': 32,
           'gamma': 0.45,
           'lam': 4.05,
           'learning_rate': 0.001,
           'mu': 0.4,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HAR_S3Layer():
    def __init__(self):
        super(HAR_S3Layer, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            # 64*2*2,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {
            'DANCE': {'batch_size': 64,
           'eta': 0.05,
           'learning_rate': 0.0001,
           'margin': 0.6000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
             'OVANet': {'batch_size': 32,
                        'learning_rate': 0.5,
                        'num_epochs': 20,
                        'num_epochs_pr': 20,
                        'weight_decay': 0.0001},
             'PPOT': {'alpha': 0.001,
                      'batch_size': 32,
                      'beta': 0.001,
                      'learning_rate': 0.0001,
                      'n_entropy': 0.5,
                      'neg': 0.3,
                      'num_epochs': 20,
                      'num_epochs_pr': 20,
                      'ot': 0.2,
                      'p_entropy': 0.3,
                      'reg': 0.01,
                      'tau': 0.2,
                      'tau1': 0.9000000000000001,
                      'tau2': 1.6,
                      'thresh': 1,
                      'weight_decay': 0.0001},
             'UDA': {'batch_size': 64,
                     'domain_loss_wt': 0.7500000000000001,
                     'learning_rate': 0.0001,
                     'num_epochs': 20,
                     'num_epochs_pr': 20,
                     'src_cls_loss_wt': 0.3,
                     'w0': 1,
                     'weight_decay': 0.0001},
             'UniJDOT': {'K': 20,
                         'alpha': 1,
                         'batch_size': 32,
                         'joint_decision': True,
                         'lamb': 1.7000000000000002,
                         'learning_rate': 0.001,
                         'n_batch': 10,
                         'num_epochs': 20,
                         'num_epochs_pr': 20,
                         'src_weight': 0.3,
                         'threshold_method': 'threshold_yen',
                         'trg_mem_size': 128,
                         'weight_decay': 0.0001},
             'UniOT': {'K': 10,
                       'MQ_size': 128,
                       'batch_size': 64,
                       'gamma': 0.15000000000000002,
                       'lam': 0.8,
                       'learning_rate': 0.0001,
                       'mu': 0.15000000000000002,
                       'num_epochs': 20,
                       'num_epochs_pr': 20,
                       'temp': 1,
                       'weight_decay': 0.0001}}


class EEG_TSLANet():
    def __init__(self):
        super(EEG_TSLANet, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 20, #4,
            'num_epochs_pr': 20,  # 20,
            'weight_decay': 1e-4,

        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 1.7000000000000002,
           'learning_rate': 0.0001,
           'margin': 0.8500000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.01,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.01,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.0001,
          'n_entropy': 1.7000000000000002,
          'neg': 0.5,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.7500000000000001,
          'p_entropy': 0.1,
          'reg': 0.1,
          'tau': 0.5,
          'tau1': 0.8500000000000001,
          'tau2': 1.2000000000000002,
          'thresh': 0.7500000000000001,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 4.8500000000000005,
         'learning_rate': 0.0005,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.95,
         'w0': 0.55,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 20,
             'alpha': 0.15000000000000002,
             'batch_size': 32,
             'joint_decision': True,
             'lamb': 0.7000000000000001,
             'learning_rate': 0.001,
             'n_batch': 30,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 1.35,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 32,
             'weight_decay': 0.0001},
 'UniOT': {'K': 15,
           'MQ_size': 2000,
           'batch_size': 32,
           'gamma': 0.95,
           'lam': 0.15000000000000002,
           'learning_rate': 0.0001,
           'mu': 0.2,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HHAR_TSLANet():
    def __init__(self):
        super(HHAR_TSLANet).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 32,
           'eta': 3.2,
           'learning_rate': 0.0001,
           'margin': 0.9000000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.0001,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.001,
          'batch_size': 32,
          'beta': 0.001,
          'learning_rate': 0.001,
          'n_entropy': 0.2,
          'neg': 0.5,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 0.5,
          'p_entropy': 0.5,
          'reg': 0.1,
          'tau': 0.25,
          'tau1': 0.6000000000000001,
          'tau2': 1.35,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 32,
         'domain_loss_wt': 4.25,
         'learning_rate': 0.001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.25,
         'w0': 0.05,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 20,
             'alpha': 0.8500000000000001,
             'batch_size': 64,
             'joint_decision': True,
             'lamb': 1.55,
             'learning_rate': 0.0001,
             'n_batch': 15,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 1.4,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 128,
             'weight_decay': 0.0001},
 'UniOT': {'K': 20,
           'MQ_size': 1000,
           'batch_size': 64,
           'gamma': 0.7500000000000001,
           'lam': 0.6000000000000001,
           'learning_rate': 0.0001,
           'mu': 0.8500000000000001,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}


class HAR_TSLANet():
    def __init__(self):
        super(HAR_TSLANet, self).__init__()
        self.train_params = {
            'num_epochs': 20,  # 4, #50,#160, #50,#160, #250,
            'num_epochs_pr': 20,
            # 64*2*2,
            'weight_decay': 1e-4,
        }
        self.alg_hparams = {'DANCE': {'batch_size': 64,
           'eta': 0.55,
           'learning_rate': 0.0001,
           'margin': 1,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'weight_decay': 0.0001},
 'OVANet': {'batch_size': 64,
            'learning_rate': 0.005,
            'num_epochs': 20,
            'num_epochs_pr': 20,
            'weight_decay': 0.0001},
 'PPOT': {'alpha': 0.01,
          'batch_size': 64,
          'beta': 0.001,
          'learning_rate': 0.0001,
          'n_entropy': 0.7500000000000001,
          'neg': 0.4,
          'num_epochs': 20,
          'num_epochs_pr': 20,
          'ot': 2.9,
          'p_entropy': 0.3,
          'reg': 0.1,
          'tau': 0.2,
          'tau1': 0.5,
          'tau2': 1.6,
          'thresh': 1,
          'weight_decay': 0.0001},
 'UDA': {'batch_size': 64,
         'domain_loss_wt': 2.3,
         'learning_rate': 0.001,
         'num_epochs': 20,
         'num_epochs_pr': 20,
         'src_cls_loss_wt': 4.5,
         'w0': 0.4,
         'weight_decay': 0.0001},
 'UniJDOT': {'K': 5,
             'alpha': 1.8,
             'batch_size': 64,
             'joint_decision': True,
             'lamb': 3.25,
             'learning_rate': 0.0005,
             'n_batch': 15,
             'num_epochs': 20,
             'num_epochs_pr': 20,
             'src_weight': 3.65,
             'threshold_method': 'threshold_yen',
             'trg_mem_size': 128,
             'weight_decay': 0.0001},
 'UniOT': {'K': 15,
           'MQ_size': 2000,
           'batch_size': 32,
           'gamma': 1,
           'lam': 0.1,
           'learning_rate': 0.0001,
           'mu': 0.95,
           'num_epochs': 20,
           'num_epochs_pr': 20,
           'temp': 0.05,
           'weight_decay': 0.0001}}